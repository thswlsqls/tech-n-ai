# API 응답 형식 설계서

**작성 일시**: 2026-01-07  
**대상**: API 응답 형식 표준화  
**아키텍처**: RESTful API

## 목차

1. [개요](#개요)
2. [표준 성공 응답 형식](#표준-성공-응답-형식)
3. [에러 응답 형식](#에러-응답-형식)
4. [페이징 응답 형식](#페이징-응답-형식)
5. [응답 예시](#응답-예시)

---

## 개요

이 설계서는 모든 API 응답이 일관된 형식을 따르도록 표준화합니다. 성공 응답과 에러 응답을 명확히 구분하고, 페이징 정보를 표준화합니다.

### 설계 원칙

1. **일관성**: 모든 API 응답이 동일한 구조를 따름
2. **명확성**: 성공/에러 응답이 명확히 구분됨
3. **국제화 지원**: 메시지 코드를 통한 다국어 지원
4. **확장성**: 향후 필드 추가가 용이한 구조

---

## 표준 성공 응답 형식

### 기본 구조

모든 성공 응답은 다음 구조를 따릅니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": {
    // 응답 데이터
  }
}
```

### 필드 설명

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| code | String | 필수 | 응답 코드 (성공: "2000", 기타 비즈니스 코드) |
| messageCode | Object | 필수 | 메시지 코드 객체 (국제화 지원) |
| messageCode.code | String | 필수 | 메시지 코드 |
| messageCode.text | String | 필수 | 메시지 텍스트 (기본 언어) |
| message | String | 필수 | 응답 메시지 (기본: "success") |
| data | Object/Array/null | 필수 | 응답 데이터 객체 |

### 응답 코드

- **2000**: 일반 성공
- 기타 비즈니스 코드는 필요에 따라 확장 가능

---

## 에러 응답 형식

### 기본 구조

모든 에러 응답은 다음 구조를 따릅니다:

```json
{
  "code": "4000",
  "messageCode": {
    "code": "BAD_REQUEST",
    "text": "잘못된 요청입니다."
  }
}
```

### 필드 설명

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| code | String | 필수 | 에러 코드 (예: "4000", "4001", "5000" 등) |
| messageCode | Object | 필수 | 에러 메시지 코드 객체 |
| messageCode.code | String | 필수 | 에러 메시지 코드 |
| messageCode.text | String | 필수 | 에러 메시지 텍스트 (국제화 지원) |

**주의**: 에러 응답에는 `message` 필드와 `data` 필드가 없습니다.

### 에러 코드 체계

에러 코드는 HTTP 상태 코드와 별도로 비즈니스 에러 코드를 사용합니다:

- **2xxx**: 성공
- **4xxx**: 클라이언트 에러
  - 4000: 잘못된 요청
  - 4001: 인증 실패
  - 4003: 권한 없음
  - 4004: 리소스 없음
  - 4029: Rate limit 초과
- **5xxx**: 서버 에러
  - 5000: 내부 서버 오류
  - 5003: 서비스 불가 (외부 API 장애 등)

자세한 에러 코드는 `4. error-handling-strategy-design.md`를 참고하세요.

---

## 페이징 응답 형식

### 페이징이 있는 응답

리스트 조회 API는 다음 페이징 구조를 사용합니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": {
    "pageSize": 10,
    "pageNumber": 1,
    "totalPageNumber": 10,
    "totalSize": 100,
    "list": [
      // 데이터 리스트 배열
    ]
  }
}
```

### 필드 설명

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| pageSize | Integer | 필수 | 페이지 크기 |
| pageNumber | Integer | 필수 | 현재 페이지 번호 (1부터 시작) |
| totalPageNumber | Integer | 필수 | 전체 페이지 수 |
| totalSize | Integer | 필수 | 전체 데이터 수 |
| list | Array | 필수 | 데이터 리스트 배열 |

### 페이징 계산 규칙

- `totalPageNumber = Math.ceil(totalSize / pageSize)`
- `pageNumber`는 1부터 시작
- `pageSize`는 기본값 10, 최대값 100

---

## 응답 예시

### 단일 객체 응답

단일 객체를 반환하는 API는 `data` 필드에 객체를 직접 포함합니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": {
    "_id": "507f1f77bcf86cd799439012",
    "title": "Codeforces Round 900",
    "startDate": "2026-01-15T10:00:00Z",
    "endDate": "2026-01-15T12:30:00Z",
    "status": "UPCOMING"
  }
}
```

### 리스트 응답 (페이징 없음)

페이징이 없는 리스트 응답은 `data` 필드에 배열을 직접 포함합니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": [
    {
      "_id": "507f1f77bcf86cd799439012",
      "title": "Codeforces Round 900"
    },
    {
      "_id": "507f1f77bcf86cd799439013",
      "title": "Codeforces Round 901"
    }
  ]
}
```

### 리스트 응답 (페이징 있음)

페이징이 있는 리스트 응답은 `data` 필드에 페이징 정보와 리스트를 포함합니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": {
    "pageSize": 10,
    "pageNumber": 1,
    "totalPageNumber": 5,
    "totalSize": 50,
    "list": [
      {
        "_id": "507f1f77bcf86cd799439012",
        "title": "Codeforces Round 900",
        "startDate": "2026-01-15T10:00:00Z",
        "endDate": "2026-01-15T12:30:00Z",
        "status": "UPCOMING"
      },
      {
        "_id": "507f1f77bcf86cd799439013",
        "title": "Codeforces Round 901",
        "startDate": "2026-01-16T10:00:00Z",
        "endDate": "2026-01-16T12:30:00Z",
        "status": "UPCOMING"
      }
    ]
  }
}
```

### 빈 응답

데이터가 없는 경우 `data` 필드를 `null` 또는 빈 객체로 설정합니다:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": null
}
```

또는:

```json
{
  "code": "2000",
  "messageCode": {
    "code": "SUCCESS",
    "text": "성공"
  },
  "message": "success",
  "data": {}
}
```

### 에러 응답 예시

#### 잘못된 요청 (400 Bad Request)

```json
{
  "code": "4000",
  "messageCode": {
    "code": "BAD_REQUEST",
    "text": "잘못된 요청입니다."
  }
}
```

#### 인증 실패 (401 Unauthorized)

```json
{
  "code": "4001",
  "messageCode": {
    "code": "AUTH_FAILED",
    "text": "인증에 실패했습니다."
  }
}
```

#### 권한 없음 (403 Forbidden)

```json
{
  "code": "4003",
  "messageCode": {
    "code": "FORBIDDEN",
    "text": "권한이 없습니다."
  }
}
```

#### 리소스 없음 (404 Not Found)

```json
{
  "code": "4004",
  "messageCode": {
    "code": "NOT_FOUND",
    "text": "리소스를 찾을 수 없습니다."
  }
}
```

#### Rate limit 초과 (429 Too Many Requests)

```json
{
  "code": "4029",
  "messageCode": {
    "code": "RATE_LIMIT_EXCEEDED",
    "text": "요청 한도를 초과했습니다."
  }
}
```

#### 내부 서버 오류 (500 Internal Server Error)

```json
{
  "code": "5000",
  "messageCode": {
    "code": "INTERNAL_SERVER_ERROR",
    "text": "내부 서버 오류가 발생했습니다."
  }
}
```

#### 서비스 불가 (503 Service Unavailable)

```json
{
  "code": "5003",
  "messageCode": {
    "code": "SERVICE_UNAVAILABLE",
    "text": "서비스를 사용할 수 없습니다."
  }
}
```

---

## 국제화 (i18n) 지원

### 메시지 코드 구조

`messageCode` 객체는 국제화를 지원합니다:

```json
{
  "code": "SUCCESS",
  "text": "성공"
}
```

- `code`: 메시지 코드 (언어에 관계없이 동일)
- `text`: 메시지 텍스트 (기본 언어, 향후 다국어 지원 확장 가능)

### 향후 확장

향후 다국어 지원을 위해 `messageCode` 객체를 확장할 수 있습니다:

```json
{
  "code": "SUCCESS",
  "text": "성공",
  "textEn": "Success",
  "textJa": "成功"
}
```

또는 Accept-Language 헤더를 기반으로 적절한 언어의 텍스트를 반환할 수 있습니다.

---

## 응답 처리 규칙

### 성공 응답 처리

1. **단일 객체 응답**: `data` 필드에 객체 직접 포함
2. **리스트 응답 (페이징 없음)**: `data` 필드에 배열 직접 포함
3. **리스트 응답 (페이징 있음)**: `data` 필드에 페이징 정보와 `list` 배열 포함
4. **빈 응답**: `data` 필드를 `null` 또는 빈 객체로 설정

### 에러 응답 처리

1. **에러 응답**: `code`, `messageCode` 필드만 포함
2. **`message` 필드 없음**: 에러 응답에는 `message` 필드가 없음
3. **`data` 필드 없음**: 에러 응답에는 `data` 필드가 없음

### HTTP 상태 코드 매핑

HTTP 상태 코드와 비즈니스 에러 코드는 분리되어 사용됩니다:

- **200 OK**: 성공 응답 (비즈니스 코드: "2000")
- **400 Bad Request**: 잘못된 요청 (비즈니스 코드: "4000")
- **401 Unauthorized**: 인증 실패 (비즈니스 코드: "4001")
- **403 Forbidden**: 권한 없음 (비즈니스 코드: "4003")
- **404 Not Found**: 리소스 없음 (비즈니스 코드: "4004")
- **429 Too Many Requests**: Rate limit 초과 (비즈니스 코드: "4029")
- **500 Internal Server Error**: 서버 오류 (비즈니스 코드: "5000")
- **503 Service Unavailable**: 서비스 불가 (비즈니스 코드: "5003")

자세한 내용은 `4. error-handling-strategy-design.md`를 참고하세요.

---

## 결론

이 설계서는 모든 API 응답이 일관된 형식을 따르도록 표준화합니다. 성공 응답과 에러 응답을 명확히 구분하고, 페이징 정보를 표준화하여 API 사용성을 향상시킵니다.

### 주요 특징

1. ✅ **일관된 응답 구조**: 모든 API 응답이 동일한 구조를 따름
2. ✅ **명확한 성공/에러 구분**: 성공 응답과 에러 응답이 명확히 구분됨
3. ✅ **표준화된 페이징**: 페이징 정보가 일관되게 제공됨
4. ✅ **국제화 지원**: 메시지 코드를 통한 다국어 지원 준비
5. ✅ **확장성**: 향후 필드 추가가 용이한 구조

### 다음 단계

1. 공통 응답 DTO 클래스 생성
2. 에러 응답 DTO 클래스 생성
3. 페이징 응답 DTO 클래스 생성
4. 응답 변환 유틸리티 구현
5. 국제화 메시지 리소스 파일 생성

---

**문서 버전**: 1.0  
**최종 업데이트**: 2026-01-07  
**작성자**: API Response Format Architect

