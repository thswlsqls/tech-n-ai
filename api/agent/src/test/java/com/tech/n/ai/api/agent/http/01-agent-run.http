###
# POST /api/v1/agent/run - Emerging Tech Agent ìˆ˜ë™ ì‹¤í–‰ API í…ŒìŠ¤íŠ¸
# Description: Emerging Tech Agentë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ì—¬ AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
# Authentication: Gatewayì—ì„œ JWT ADMIN ì—­í•  ê²€ì¦ í›„ x-user-id í—¤ë” ì£¼ì…
# @no-cookie-jar
###

### ============================================
### ì •ìƒ ì¼€ì´ìŠ¤ (Success Cases)
### ============================================

### 1. ê¸°ë³¸ Agent ì‹¤í–‰ (sessionId ìë™ ìƒì„±)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ìµœê·¼ AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("Agent ì‹¤í–‰ ì„±ê³µ - HTTP 200", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("Agent ì‹¤í–‰ ì„±ê³µ - ApiResponse êµ¬ì¡° í™•ì¸", function() {
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.messageCode.code === "SUCCESS", "messageCode.codeê°€ SUCCESSì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.message === "success", "messageê°€ successì—¬ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("Agent ì‹¤í–‰ ì„±ê³µ - AgentExecutionResult í•„ë“œ í™•ì¸", function() {
        var data = response.body.data;
        client.assert(data.success !== undefined, "success í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(data.summary !== undefined, "summary í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(data.toolCallCount !== undefined, "toolCallCount í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(data.analyticsCallCount !== undefined, "analyticsCallCount í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(data.executionTimeMs !== undefined, "executionTimeMs í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(data.errors !== undefined, "errors í•„ë“œê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("Agent ì‹¤í–‰ ì„±ê³µ - ë°ì´í„° íƒ€ì… í™•ì¸", function() {
        var data = response.body.data;
        client.assert(typeof data.success === "boolean", "successê°€ booleanì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.summary === "string", "summaryê°€ ë¬¸ìì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.toolCallCount === "number", "toolCallCountê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.analyticsCallCount === "number", "analyticsCallCountê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.executionTimeMs === "number", "executionTimeMsê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(Array.isArray(data.errors), "errorsê°€ ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 2. sessionId ì§€ì •í•˜ì—¬ ì‹¤í–‰
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "GitHubì—ì„œ ìµœì‹  AI í”„ë ˆì„ì›Œí¬ ë¦´ë¦¬ìŠ¤ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
  "sessionId": "test-session-001"
}

> {%
    client.test("sessionId ì§€ì • ì‹¤í–‰ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("Agent ì‘ë‹µ ë°ì´í„° íƒ€ì… í™•ì¸", function() {
        var data = response.body.data;
        client.assert(typeof data.summary === "string", "summaryê°€ ë¬¸ìì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.toolCallCount === "number", "toolCallCountê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.analyticsCallCount === "number", "analyticsCallCountê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(typeof data.executionTimeMs === "number", "executionTimeMsê°€ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(Array.isArray(data.errors), "errorsê°€ ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 3. ë‹¤ì–‘í•œ goal í…ŒìŠ¤íŠ¸ - OpenAI ê´€ë ¨ ì •ë³´ ìˆ˜ì§‘
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "OpenAIì˜ ìµœì‹  ëª¨ë¸ ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("OpenAI ì •ë³´ ìˆ˜ì§‘ ìš”ì²­ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 4. ë‹¤ì–‘í•œ goal í…ŒìŠ¤íŠ¸ - Anthropic ê´€ë ¨ ì •ë³´ ìˆ˜ì§‘
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "Anthropic Claudeì˜ ìµœì‹  ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("Anthropic ì •ë³´ ìˆ˜ì§‘ ìš”ì²­ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 5. ë‹¤ì–‘í•œ goal í…ŒìŠ¤íŠ¸ - ì—¬ëŸ¬ AI ë„êµ¬ ì •ë³´ ìˆ˜ì§‘
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "LangChain, LlamaIndex, Hugging Faceì˜ ìµœì‹  ë¦´ë¦¬ìŠ¤ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("ì—¬ëŸ¬ AI ë„êµ¬ ì •ë³´ ìˆ˜ì§‘ ìš”ì²­ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 6. ê¸´ goal ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ìµœê·¼ í•œ ì£¼ê°„ ë°œí‘œëœ AI ê´€ë ¨ ì—…ë°ì´íŠ¸ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”. íŠ¹íˆ ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸(LLM), ì´ë¯¸ì§€ ìƒì„± AI, ì½”ë“œ ìƒì„± ë„êµ¬, AI í”„ë ˆì„ì›Œí¬ ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì˜ ì—…ë°ì´íŠ¸ë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("ê¸´ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 7. íŠ¹ìˆ˜ ë¬¸ìê°€ í¬í•¨ëœ goal í…ŒìŠ¤íŠ¸
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "GPT-4o, Claude 3.5, Gemini 1.5 Pro ë“±ì˜ ìµœì‹  ë²„ì „ ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("íŠ¹ìˆ˜ ë¬¸ì í¬í•¨ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 8. í•œê¸€ goal í…ŒìŠ¤íŠ¸
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ì¸ê³µì§€ëŠ¥ ëª¨ë¸ë“¤ì˜ í•œêµ­ì–´ ì§€ì› ì—…ë°ì´íŠ¸ í˜„í™©ì„ í™•ì¸í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("í•œê¸€ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### ============================================
### ì‹¤íŒ¨ ì¼€ì´ìŠ¤ (Failure Cases)
### ============================================

### 9. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - goal í•„ë“œ ëˆ„ë½
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "sessionId": "test-session-002"
}

> {%
    client.test("goal ëˆ„ë½ - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("goal ëˆ„ë½ - ìœ íš¨ì„± ê²€ì¦ ì—ëŸ¬ ì½”ë“œ", function() {
        client.assert(response.body.code === "4006", "codeê°€ 4006(VALIDATION_ERROR)ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.messageCode.code === "VALIDATION_ERROR", "messageCode.codeê°€ VALIDATION_ERRORì—¬ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("goal ëˆ„ë½ - í•„ë“œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸", function() {
        client.assert(response.body.data.goal !== undefined, "goal í•„ë“œ ì—ëŸ¬ê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.data.goal === "goalì€ í•„ìˆ˜ì…ë‹ˆë‹¤.", "goal ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì •í™•í•´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 10. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ë¹ˆ goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": ""
}

> {%
    client.test("ë¹ˆ goal - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("ë¹ˆ goal - ìœ íš¨ì„± ê²€ì¦ ì—ëŸ¬", function() {
        client.assert(response.body.code === "4006", "codeê°€ 4006ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.data.goal !== undefined, "goal í•„ë“œ ì—ëŸ¬ê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 11. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ê³µë°±ë§Œ ìˆëŠ” goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "   "
}

> {%
    client.test("ê³µë°± goal - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("ê³µë°± goal - @NotBlank ìœ íš¨ì„± ê²€ì¦", function() {
        client.assert(response.body.code === "4006", "codeê°€ 4006ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.data.goal !== undefined, "goal í•„ë“œ ì—ëŸ¬ê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 12. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - null goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": null
}

> {%
    client.test("null goal - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("null goal - ìœ íš¨ì„± ê²€ì¦ ì—ëŸ¬", function() {
        client.assert(response.body.code === "4006", "codeê°€ 4006ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 13. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - x-user-id í—¤ë” ëˆ„ë½
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("x-user-id ëˆ„ë½ - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 14. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ë¹ˆ x-user-id í—¤ë”
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id:
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("ë¹ˆ x-user-id - ìš”ì²­ ì²˜ë¦¬", function() {
        // ë¹ˆ í—¤ë” ê°’ì€ Springì—ì„œ ë¹ˆ ë¬¸ìì—´ë¡œ ì²˜ë¦¬ë˜ì–´ 200 ë˜ëŠ” 400 ê°€ëŠ¥
        client.assert(response.status === 200 || response.status === 400,
            "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200 ë˜ëŠ” 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 15. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ì˜ëª»ëœ Content-Type
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: text/plain
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

goal=AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.

> {%
    client.test("ì˜ëª»ëœ Content-Type - HTTP 415", function() {
        client.assert(response.status === 415 || response.status === 400,
            "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 415 ë˜ëŠ” 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 16. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ë¹ˆ ìš”ì²­ ë³¸ë¬¸
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

> {%
    client.test("ë¹ˆ ìš”ì²­ ë³¸ë¬¸ - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 17. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ì˜ëª»ëœ JSON í˜•ì‹
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.",
  invalid json here
}

> {%
    client.test("ì˜ëª»ëœ JSON - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 18. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì—”ë“œí¬ì¸íŠ¸
POST {{gatewayUrl}}/api/v1/agent/unknown-endpoint
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì—”ë“œí¬ì¸íŠ¸ - HTTP 404", function() {
        client.assert(response.status === 404, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 404ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("404 ì—ëŸ¬ ì‘ë‹µ êµ¬ì¡° í™•ì¸", function() {
        client.assert(response.body.code === "4004", "codeê°€ 4004(NOT_FOUND)ì—¬ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.messageCode.code === "NOT_FOUND", "messageCode.codeê°€ NOT_FOUNDì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 19. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - goalë§Œ ì—†ëŠ” ë¹ˆ JSON ê°ì²´
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{}

> {%
    client.test("ë¹ˆ JSON ê°ì²´ - HTTP 400", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("ë¹ˆ JSON ê°ì²´ - goal ëˆ„ë½ ì—ëŸ¬", function() {
        client.assert(response.body.code === "4006", "codeê°€ 4006ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.data.goal !== undefined, "goal í•„ë“œ ì—ëŸ¬ê°€ ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### ============================================
### ì—£ì§€ ì¼€ì´ìŠ¤ (Edge Cases)
### ============================================

### 20. ì—£ì§€ ì¼€ì´ìŠ¤ - ë¹ˆ sessionId (ìë™ ìƒì„± í™•ì¸)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": ""
}

> {%
    client.test("ë¹ˆ sessionId - ìë™ ìƒì„±ë˜ì–´ HTTP 200", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 21. ì—£ì§€ ì¼€ì´ìŠ¤ - ê³µë°± sessionId (ìë™ ìƒì„± í™•ì¸)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": "   "
}

> {%
    client.test("ê³µë°± sessionId - ìë™ ìƒì„±ë˜ì–´ HTTP 200", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 22. ì—£ì§€ ì¼€ì´ìŠ¤ - ê¸´ sessionId
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": "very-long-session-id-that-might-exceed-normal-limits-1234567890-abcdefghijklmnopqrstuvwxyz"
}

> {%
    client.test("ê¸´ sessionId ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 23. ì—£ì§€ ì¼€ì´ìŠ¤ - íŠ¹ìˆ˜ ë¬¸ìê°€ í¬í•¨ëœ sessionId
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": "session@#$%^&*()_+"
}

> {%
    client.test("íŠ¹ìˆ˜ ë¬¸ì sessionId ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 24. ì—£ì§€ ì¼€ì´ìŠ¤ - ìœ ë‹ˆì½”ë“œ ë¬¸ìê°€ í¬í•¨ëœ sessionId
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": "ì„¸ì…˜-ì•„ì´ë””-í…ŒìŠ¤íŠ¸-123"
}

> {%
    client.test("ìœ ë‹ˆì½”ë“œ sessionId ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 25. ì—£ì§€ ì¼€ì´ìŠ¤ - ì¶”ê°€ í•„ë“œê°€ í¬í•¨ëœ ìš”ì²­ (ë¬´ì‹œë˜ì–´ì•¼ í•¨)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.",
  "sessionId": "test-session-extra",
  "unknownField": "should be ignored",
  "anotherUnknownField": 12345
}

> {%
    client.test("ì¶”ê°€ í•„ë“œ ë¬´ì‹œí•˜ê³  ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 26. ì—£ì§€ ì¼€ì´ìŠ¤ - ë™ì‹œ ìš”ì²­ ì‹œë®¬ë ˆì´ì…˜ (ì²« ë²ˆì§¸)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ë™ì‹œ ìš”ì²­ í…ŒìŠ¤íŠ¸ 1",
  "sessionId": "concurrent-test-1"
}

> {%
    client.test("ë™ì‹œ ìš”ì²­ ì²« ë²ˆì§¸ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 27. ì—£ì§€ ì¼€ì´ìŠ¤ - ë™ì‹œ ìš”ì²­ ì‹œë®¬ë ˆì´ì…˜ (ë‘ ë²ˆì§¸ - ê°™ì€ sessionId)
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ë™ì‹œ ìš”ì²­ í…ŒìŠ¤íŠ¸ 2",
  "sessionId": "concurrent-test-1"
}

> {%
    client.test("ë™ì¼ sessionId ì¬ì‚¬ìš© ì²˜ë¦¬", function() {
        client.assert(response.status === 200 || response.status === 409,
            "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200 ë˜ëŠ” 409ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 28. ì—£ì§€ ì¼€ì´ìŠ¤ - ë§¤ìš° ì§§ì€ goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI"
}

> {%
    client.test("ì§§ì€ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 29. ì—£ì§€ ì¼€ì´ìŠ¤ - ì´ëª¨ì§€ê°€ í¬í•¨ëœ goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ğŸ¤– AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš” ğŸš€"
}

> {%
    client.test("ì´ëª¨ì§€ í¬í•¨ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 30. ì—£ì§€ ì¼€ì´ìŠ¤ - ì¤„ë°”ê¿ˆì´ í¬í•¨ëœ goal
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.\níŠ¹íˆ LLM ê´€ë ¨ ì •ë³´ë¥¼ ì¤‘ì ì ìœ¼ë¡œ.\nìµœê·¼ ì¼ì£¼ì¼ ë‚´ ì—…ë°ì´íŠ¸ë§Œ í¬í•¨í•´ì£¼ì„¸ìš”."
}

> {%
    client.test("ì¤„ë°”ê¿ˆ í¬í•¨ goal ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 31. ì—£ì§€ ì¼€ì´ìŠ¤ - null sessionId ëª…ì‹œì  ì „ë‹¬
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸",
  "sessionId": null
}

> {%
    client.test("null sessionId - ìë™ ìƒì„±ë˜ì–´ HTTP 200", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 32. ì—£ì§€ ì¼€ì´ìŠ¤ - sessionId í•„ë“œ ì—†ì´ goalë§Œ ì „ë‹¬
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "sessionId ì—†ì´ goalë§Œ ì „ë‹¬í•˜ëŠ” í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("sessionId í•„ë“œ ì—†ì´ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 33. ì—£ì§€ ì¼€ì´ìŠ¤ - HTTP Method ì˜¤ë¥˜ (GET)
GET {{gatewayUrl}}/api/v1/agent/run
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

> {%
    client.test("GET Method - HTTP 405", function() {
        client.assert(response.status === 405, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 405ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 34. ì—£ì§€ ì¼€ì´ìŠ¤ - HTTP Method ì˜¤ë¥˜ (PUT)
PUT {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("PUT Method - HTTP 405", function() {
        client.assert(response.status === 405, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 405ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 35. ì—£ì§€ ì¼€ì´ìŠ¤ - HTTP Method ì˜¤ë¥˜ (DELETE)
DELETE {{gatewayUrl}}/api/v1/agent/run
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

> {%
    client.test("DELETE Method - HTTP 405", function() {
        client.assert(response.status === 405, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 405ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 36. ì—£ì§€ ì¼€ì´ìŠ¤ - HTTP Method ì˜¤ë¥˜ (PATCH)
PATCH {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "AI ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("PATCH Method - HTTP 405", function() {
        client.assert(response.status === 405, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 405ì—¬ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 37. ì—£ì§€ ì¼€ì´ìŠ¤ - Content-Typeì— charset í¬í•¨
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json; charset=UTF-8
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "charset ëª…ì‹œ í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("Content-Type charset í¬í•¨ - HTTP 200", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 38. ì—£ì§€ ì¼€ì´ìŠ¤ - ë‹¤ë¥¸ x-user-idë¡œ ì‹¤í–‰
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: different-admin-user-999
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ë‹¤ë¥¸ ì‚¬ìš©ì IDë¡œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸"
}

> {%
    client.test("ë‹¤ë¥¸ x-user-id ì²˜ë¦¬ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}

### 39. ì—£ì§€ ì¼€ì´ìŠ¤ - Agent ì‹¤í–‰ ì‹¤íŒ¨ ì‹œ ì‘ë‹µ êµ¬ì¡° í™•ì¸ (ì˜ë„ì  ì‹¤íŒ¨ ìœ ë°œì€ ë¶ˆê°€í•˜ë‚˜ ì‘ë‹µ êµ¬ì¡° ë¬¸ì„œí™”)
# Agentê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì‹¤íŒ¨í•˜ë©´ success=false, errors ë°°ì—´ì— ì—ëŸ¬ ë©”ì‹œì§€ê°€ í¬í•¨ë¨
# ì´ í…ŒìŠ¤íŠ¸ëŠ” Agent ì‹¤í–‰ ê²°ê³¼ì˜ errors í•„ë“œê°€ ë°°ì—´ì¸ì§€ í™•ì¸
POST {{gatewayUrl}}/api/v1/agent/run
Content-Type: application/json
x-user-id: {{adminId}}
Authorization: Bearer {{adminAccessToken}}

{
  "goal": "ë¹„ì •ìƒì ì¸ URL scraping í…ŒìŠ¤íŠ¸: https://this-domain-does-not-exist-12345.invalid"
}

> {%
    client.test("Agent ì‹¤í–‰ ì‘ë‹µ - HTTP 200 (Agent ë‚´ë¶€ ì—ëŸ¬ëŠ” dataì— í¬í•¨)", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ìƒíƒœ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•©ë‹ˆë‹¤ (Agent ë‚´ë¶€ ì‹¤íŒ¨ë„ 200ìœ¼ë¡œ ë°˜í™˜)");
        client.assert(response.body.code === "2000", "codeê°€ 2000ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });

    client.test("Agent ì‘ë‹µ - errors í•„ë“œ í™•ì¸", function() {
        var data = response.body.data;
        client.assert(Array.isArray(data.errors), "errorsê°€ ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤");
    });
%}
