###
# GET /api/v1/bookmark/search - 북마크 검색 API 테스트
# Description: 북마크를 키워드로 검색합니다.
# Authentication: Required (Bearer Token)
###

### 1. 기본 검색
GET {{gatewayUrl}}/api/v1/bookmark/search?q=openai
Authorization: Bearer {{accessToken}}

> {%
    client.test("북마크 검색 성공", function() {
        client.assert(response.status === 200, "응답 상태 코드가 200이어야 합니다");
        client.assert(response.body.code === "2000", "code 필드가 2000이어야 합니다");
    });

    client.test("검색 응답 데이터 확인", function() {
        var data = response.body.data;
        client.assert(data.data !== undefined, "PageData가 존재해야 합니다");
    });
%}

### 2. 검색 + 페이지네이션
GET {{gatewayUrl}}/api/v1/bookmark/search?q=openai&page=1&size=5
Authorization: Bearer {{accessToken}}

> {%
    client.test("검색 페이지네이션 성공", function() {
        client.assert(response.status === 200, "응답 상태 코드가 200이어야 합니다");
    });
%}

### 3. 검색 + searchField 지정
GET {{gatewayUrl}}/api/v1/bookmark/search?q=AI&searchField=tag
Authorization: Bearer {{accessToken}}

> {%
    client.test("searchField 검색 성공", function() {
        client.assert(response.status === 200, "응답 상태 코드가 200이어야 합니다");
    });
%}

### 4. 검색 + searchField=title 지정
GET {{gatewayUrl}}/api/v1/bookmark/search?q=openai&searchField=title
Authorization: Bearer {{accessToken}}

> {%
    client.test("searchField=title 검색 성공", function() {
        client.assert(response.status === 200, "응답 상태 코드가 200이어야 합니다");
    });
%}

### 5. 검색 - 결과 없는 검색어
GET {{gatewayUrl}}/api/v1/bookmark/search?q=zzzzzznonexistentkeyword
Authorization: Bearer {{accessToken}}

> {%
    client.test("빈 검색 결과", function() {
        client.assert(response.status === 200, "응답 상태 코드가 200이어야 합니다");
    });

    client.test("빈 결과 확인", function() {
        var data = response.body.data;
        client.assert(data.data.list.length === 0, "결과가 비어있어야 합니다");
    });
%}

### 5. 실패 케이스 - 검색어 누락
GET {{gatewayUrl}}/api/v1/bookmark/search
Authorization: Bearer {{accessToken}}

> {%
    client.test("유효성 검증 실패 - 검색어 누락", function() {
        client.assert(response.status === 400, "응답 상태 코드가 400이어야 합니다");
        client.assert(response.body.code === "4006", "code 필드가 4006(VALIDATION_ERROR)이어야 합니다");
    });
%}

### 6. 실패 케이스 - 빈 검색어
GET {{gatewayUrl}}/api/v1/bookmark/search?q=
Authorization: Bearer {{accessToken}}

> {%
    client.test("유효성 검증 실패 - 빈 검색어", function() {
        client.assert(response.status === 400, "응답 상태 코드가 400이어야 합니다");
        client.assert(response.body.code === "4006", "code 필드가 4006(VALIDATION_ERROR)이어야 합니다");
    });
%}

### 7. 실패 케이스 - 공백만 있는 검색어
GET {{gatewayUrl}}/api/v1/bookmark/search?q=%20%20%20
Authorization: Bearer {{accessToken}}

> {%
    client.test("유효성 검증 실패 - 공백 검색어", function() {
        client.assert(response.status === 400, "응답 상태 코드가 400이어야 합니다");
        client.assert(response.body.code === "4006", "code 필드가 4006(VALIDATION_ERROR)이어야 합니다");
    });
%}

### 8. 실패 케이스 - 인증 없이 요청
GET {{gatewayUrl}}/api/v1/bookmark/search?q=test

> {%
    client.test("인증 필요 오류", function() {
        client.assert(response.status === 401, "응답 상태 코드가 401이어야 합니다");
    });
%}

### 9. 실패 케이스 - 잘못된 토큰
GET {{gatewayUrl}}/api/v1/bookmark/search?q=test
Authorization: Bearer invalid_token_here

> {%
    client.test("인증 실패 오류", function() {
        client.assert(response.status === 401, "응답 상태 코드가 401이어야 합니다");
    });
%}

### 10. 실패 케이스 - size 초과
GET {{gatewayUrl}}/api/v1/bookmark/search?q=test&page=1&size=101
Authorization: Bearer {{accessToken}}

> {%
    client.test("파라미터 검증 실패 - size 초과", function() {
        client.assert(response.status === 400, "응답 상태 코드가 400이어야 합니다");
        client.assert(response.body.code === "4006", "code 필드가 4006(VALIDATION_ERROR)이어야 합니다");
    });
%}
