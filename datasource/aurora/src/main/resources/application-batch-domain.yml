spring:
  jpa:
    batch:
      open-in-view: false
      generate-ddl: false
      database: mysql
      # database-platform 제거 - Hibernate 6.x 자동 감지 사용
      hibernate.ddl-auto: none
      show-sql: true
      properties:
        hibernate:
          storage_engine: innodb
          hbm2ddl.import_files_sql_extractor: org.hibernate.tool.hbm2ddl.MultipleLinesSqlCommandExtractor
          default_batch_fetch_size: ${DB_FETCH_CHUNKSIZE:250}
          format_sql: true
          highlight_sql: true
          use_sql_comments: true
          connection.provider_disables_autocommit: true
          connection.provider_disables_autocommit_false: false
          globally_quoted_identifiers: true
          order_inserts: true
          order_updates: true
          implicit_naming_strategy: com.tech.n.ai.domain.mariadb.utils.JpaImplicitNamingStrategyCustom
          physical_naming_strategy: com.tech.n.ai.domain.mariadb.utils.JpaPhysicalNamingStrategyCustom
          jdbc:
            batch_size: ${DB_BATCH_SIZE:50}
            time_zone: ${TZ:Asia/Seoul}

  datasource:
    batch:
      meta:
        hikari:
          driver-class-name: software.aws.rds.jdbc.mysql.Driver
          connection-timeout: 5000
          validation-timeout: 5000
          max-lifetime: 28795000 
          idle-timeout: 300000 
          connection-test-query: SELECT 1 
          minimum-idle: 5
          maximum-pool-size: 20
          auto-commit: false
          transaction-isolation: TRANSACTION_READ_UNCOMMITTED
          data-source-properties:
            connectTimeout: 5000
            socketTimeout: 60000 
            useUnicode: true
            characterEncoding: utf-8
            rewriteBatchedStatements: true
            cachePrepStmts: true
            prepStmtCacheSize: 250
            prepStmtCacheSqlLimit: 2048
            useServerPrepStmts: true
            wrapperPlugins: readWriteSplitting,failover,efm
            failoverMode: reader-or-writer
      writer:
        hikari:
          driver-class-name: software.aws.rds.jdbc.mysql.Driver
          connection-timeout: 5000
          validation-timeout: 5000
          max-lifetime: 28795000
          idle-timeout: 300000
          minimum-idle: 5
          maximum-pool-size: 20
          auto-commit: false
          transaction-isolation: TRANSACTION_READ_UNCOMMITTED
          data-source-properties:
            connectTimeout: 5000
            socketTimeout: 60000
            useUnicode: true
            characterEncoding: utf-8
            rewriteBatchedStatements: true
            cachePrepStmts: true
            prepStmtCacheSize: 250
            prepStmtCacheSqlLimit: 2048
            useServerPrepStmts: true
            wrapperPlugins: readWriteSplitting,failover,efm
            failoverMode: reader-or-writer
      reader:
        hikari:
          driver-class-name: software.aws.rds.jdbc.mysql.Driver
          connection-timeout: 5000
          validation-timeout: 5000
          max-lifetime: 28795000
          idle-timeout: 300000
          minimum-idle: 5
          maximum-pool-size: 20
          auto-commit: false
          transaction-isolation: TRANSACTION_READ_UNCOMMITTED
          data-source-properties:
            connectTimeout: 5000
            socketTimeout: 60000
            useUnicode: true
            characterEncoding: utf-8
            rewriteBatchedStatements: true
            cachePrepStmts: true
            prepStmtCacheSize: 250
            prepStmtCacheSqlLimit: 2048
            useServerPrepStmts: true
            wrapperPlugins: readWriteSplitting,failover,efm
            failoverMode: reader-or-writer

management:
  health:
    db:
      enabled: false

logging:
  level:
    # Hibernate 내부 로그 최소화 (TRACE/DEBUG → WARN)
    org.hibernate: warn
    org.hibernate.SQL: info
    org.hibernate.type: warn
    org.hibernate.type.descriptor.sql: warn
    org.hibernate.orm.deprecation: error
    # MongoDB 로그 최소화
    org.mongodb.driver: warn
    # Spring Data 로그 최소화
    org.springframework.data: warn

mybatis:
  config-location: "classpath:mapper-config.xml"

---
spring:
  config.activate.on-profile: local,dev

  datasource:
    writer:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema:batch}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema:batch}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
    reader:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema:batch}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema:batch}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234


---
spring:
  config.activate.on-profile: beta

  datasource:
    writer:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
    reader:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234


---
spring:
  config.activate.on-profile: prod

  jpa:
    show-sql: false

  datasource:
    writer:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
    reader:
      meta:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.meta.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234
      business:
        url: jdbc:mysql://tech-n-ai-aurora-cluster-instance-1.c8hcnykzcnr8.ap-northeast-2.rds.amazonaws.com:3306/${module.aurora.business.schema}?${AURORA_OPTIONS:useSSL=true&serverTimezone=Asia/Seoul&characterEncoding=UTF-8}
        username: admin
        password: admin1234

logging:
level:
  org.hibernate.type: error
  org.hibernate.sql: error